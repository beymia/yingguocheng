(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/orderPayment/orderPayment"],{111:
/*!**********************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/main.js?{"page":"pages%2ForderPayment%2ForderPayment"} ***!
  \**********************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";(function(t){n(/*! uni-pages */7);o(n(/*! vue */2));var e=o(n(/*! ./pages/orderPayment/orderPayment.vue */112));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},112:
/*!***************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/orderPayment/orderPayment.vue ***!
  \***************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var o=n(/*! ./orderPayment.vue?vue&type=template&id=34761706&scoped=true& */113),r=n(/*! ./orderPayment.vue?vue&type=script&lang=js& */115);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n(/*! ./orderPayment.vue?vue&type=style&index=0&id=34761706&lang=scss&scoped=true& */117);var s,c=n(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */13),i=Object(c["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,"34761706",null,!1,o["components"],s);i.options.__file="pages/orderPayment/orderPayment.vue",e["default"]=i.exports},113:
/*!**********************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/orderPayment/orderPayment.vue?vue&type=template&id=34761706&scoped=true& ***!
  \**********************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,n){"use strict";n.r(e);var o=n(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orderPayment.vue?vue&type=template&id=34761706&scoped=true& */114);n.d(e,"render",(function(){return o["render"]})),n.d(e,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(e,"components",(function(){return o["components"]}))},114:
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/yingguocheng/pages/orderPayment/orderPayment.vue?vue&type=template&id=34761706&scoped=true& ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,n){"use strict";n.r(e),n.d(e,"render",(function(){return r})),n.d(e,"staticRenderFns",(function(){return s})),n.d(e,"recyclableRender",(function(){return a})),n.d(e,"components",(function(){return o}));var o={uniIcons:function(){return Promise.all(/*! import() | components/uni-icons/uni-icons */[n.e("common/vendor"),n.e("components/uni-icons/uni-icons")]).then(n.bind(null,/*! @/components/uni-icons/uni-icons.vue */347))}},r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.__map(t.attach,(function(e,n){var o=t.__get_orig(e),r=t.attachArr.indexOf(e.id);return{$orig:o,g0:r}})));t._isMounted||(t.e0=function(e){t.discountAmount=0},t.e1=function(e){t.isRemarks=!t.isRemarks},t.e2=function(e){t.isRemarks=!t.isRemarks}),t.$mp.data=Object.assign({},{$root:{l0:n}})},a=!1,s=[];r._withStripped=!0},115:
/*!****************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/orderPayment/orderPayment.vue?vue&type=script&lang=js& ***!
  \****************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var o=n(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orderPayment.vue?vue&type=script&lang=js& */116),r=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},116:
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/yingguocheng/pages/orderPayment/orderPayment.vue?vue&type=script&lang=js& ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n(/*! ./node_modules/@babel/runtime/regenerator */4)),r=n(/*! ../../request/api */25);a(n(/*! ../order/order */38));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,o,r,a,s){try{var c=t[a](s),i=c.value}catch(u){return void n(u)}c.done?e(i):Promise.resolve(i).then(o,r)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function c(t){s(a,o,r,c,i,"next",t)}function i(t){s(a,o,r,c,i,"throw",t)}c(void 0)}))}}var i=function(){n.e(/*! require.ensure | components-lk/remarks/remarks */"components-lk/remarks/remarks").then(function(){return resolve(n(/*! ../../components-lk/remarks/remarks */482))}.bind(null,n)).catch(n.oe)},u=getApp().globalData,d={data:function(){return{userPhone:"",isRemarks:!1,remarksData:{},remarksArr:["無接觸配送","紙巾","糖包"],discountAmount:0,goodsPrice:0,goodsData:[],attach:{},totalAmount:0,attachArr:[],couponInfo:[],paymentStatus:!1}},computed:{computeProgress:function(){var t=this.goodsData,e=t.current_cups,n=t.current_order;return n/e*100}},onLoad:function(){var t=this;return c(o.default.mark((function e(){var n,a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.goodsData=u.goodsPayment,t.goods_data=[],t.goodsId="",t.goodsData.goods_data.forEach((function(e,n){t.goodsId+=e.id,t.goods_data.push({id:e.id,num:e.goods_num,norm:e.norm_id})})),t.totalAmount=parseFloat(t.goodsData.payment_info),e.prev=5,e.next=8,(0,r.paymentAttach)();case 8:t.attach=e.sent.data,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](5),console.log(e.t0),t.attach={};case 15:return e.prev=15,e.next=18,(0,r.usedCoupon)({vehicle_method:t.goodsDatahaul_method,goods_id:t.goodsId,total_price:t.totalAmount});case 18:for(a in n=e.sent.data,n)n.hasOwnProperty(a)&&t.couponInfo.push(n[a]);e.next=26;break;case 22:e.prev=22,e.t1=e["catch"](15),console.log(e.t1),t.couponInfo=[];case 26:case"end":return e.stop()}}),e,null,[[5,11],[15,22]])})))()},onShow:function(){u.coupon.goods_quota?this.discountAmount=u.coupon.goods_quota:(this.discountAmount=0,this.couponInfo=[])},onUnload:function(){this.paymentStatus=!1,u.coupon={}},methods:{autoFill:function(){this.userPhone=u.userInfo.mobile},closeRemarks:function(t){this.isRemarks=!1,this.remarksData=t},navDiscount:function(){this.couponInfo.length&&t.navigateTo({url:"/pages/discount/discount?couponInfo="+encodeURIComponent(JSON.stringify(this.couponInfo))})},addAttachFee:function(t){var e=this,n=this;n.isAttach=!n.isAttach,n.attach.forEach((function(o){o.id===t&&(n.isAttach?(n.totalAmount+=parseFloat(e.attach[0].attach_price),n.attachArr.push(t)):(n.totalAmount-=parseFloat(e.attach[0].attach_price),n.attachArr.splice(n.attachArr.indexOf(t),1)))}))},startPay:function(){var e=this;return c(o.default.mark((function n(){var a,s,c,i,d,l,h,f,p,_,g;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.paymentStatus){n.next=2;break}return n.abrupt("return");case 2:for(f in e.paymentStatus=!0,a=e,t.showLoading({title:"請稍後"}),s=a.goodsData,c=s.shop_id,i=s.shop_name,d=s.address_id,l=s.haul_method,h={shop_id:c,shop_name:i,address_id:d,haul_method:l,goods_data:e.goods_data,remake:"",attach_id:"",ticket_id:u.coupon.id},h.goods_data=JSON.stringify(h.goods_data),a.remarksData)a.remarksData.hasOwnProperty(f)&&a.remarksData[f]&&(h.remake+=a.remarksData[f]+",");for(p in h.remake&&(h.remake=h.remake.substr(0,h.remake.length-1)),a.attachArr.length&&(a.attachArr.forEach((function(t){h.attach_id+=t+","})),h.attach_id=h.attach_id.substr(0,h.attach_id.length-1)),h)h.hasOwnProperty(p)&&(h[p]||delete h[p]);return n.prev=12,n.next=15,(0,r.createOrder)(h);case 15:return _=n.sent.data.order_id,n.next=18,(0,r.paymentStart)({order_id:_,shop_id:h.shop_id});case 18:return g=n.sent.data,console.log(1),n.next=22,a.utilPayment(g);case 22:return n.next=24,a.paymentSuccess();case 24:n.next=31;break;case 26:n.prev=26,n.t0=n["catch"](12),a.customToast("订单创建失败"),a.paymentStatus=!1,console.log(n.t0);case 31:case"end":return n.stop()}}),n,null,[[12,26]])})))()},paymentSuccess:function(){var e=this;return c(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.paymentStatus=!1,e.customToast("结算成功"),t.switchTab({url:"/pages/orderForm/orderForm"});case 3:case"end":return n.stop()}}),n)})))()}},watch:{discountAmount:function(t,e){t=parseFloat(t),e=parseFloat(e),t?this.totalAmount-=t:this.totalAmount+=e}},components:{remarks:i}};e.default=d}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},117:
/*!*************************************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/orderPayment/orderPayment.vue?vue&type=style&index=0&id=34761706&lang=scss&scoped=true& ***!
  \*************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var o=n(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./orderPayment.vue?vue&type=style&index=0&id=34761706&lang=scss&scoped=true& */118),r=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},118:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/yingguocheng/pages/orderPayment/orderPayment.vue?vue&type=style&index=0&id=34761706&lang=scss&scoped=true& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){},38:
/*!*************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/order/order.vue ***!
  \*************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var o=n(/*! ./order.vue?vue&type=template&id=127632e4&scoped=true& */39),r=n(/*! ./order.vue?vue&type=script&lang=js& */41);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n(/*! ./order.vue?vue&type=style&index=0&id=127632e4&lang=scss&scoped=true& */45);var s,c=n(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */13),i=Object(c["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,"127632e4",null,!1,o["components"],s);i.options.__file="pages/order/order.vue",e["default"]=i.exports},39:
/*!********************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/order/order.vue?vue&type=template&id=127632e4&scoped=true& ***!
  \********************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,n){"use strict";n.r(e);var o=n(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order.vue?vue&type=template&id=127632e4&scoped=true& */40);n.d(e,"render",(function(){return o["render"]})),n.d(e,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(e,"components",(function(){return o["components"]}))},40:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/yingguocheng/pages/order/order.vue?vue&type=template&id=127632e4&scoped=true& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,n){"use strict";n.r(e),n.d(e,"render",(function(){return r})),n.d(e,"staticRenderFns",(function(){return s})),n.d(e,"recyclableRender",(function(){return a})),n.d(e,"components",(function(){return o}));var o={uniNavBar:function(){return n.e(/*! import() | components/uni-nav-bar/uni-nav-bar */"components/uni-nav-bar/uni-nav-bar").then(n.bind(null,/*! @/components/uni-nav-bar/uni-nav-bar.vue */340))},uniIcons:function(){return Promise.all(/*! import() | components/uni-icons/uni-icons */[n.e("common/vendor"),n.e("components/uni-icons/uni-icons")]).then(n.bind(null,/*! @/components/uni-icons/uni-icons.vue */347))}},r=function(){var t=this,e=t.$createElement,n=(t._self._c,t.is_notice?null:t.__map(t.menu_list,(function(e,n){var o=t.__get_orig(e),r=t.__map(e.goods_list,(function(e,n){var o=t.__get_orig(e),r=t.is_rest?null:t.productCartNum(e.id);return{$orig:o,m0:r}}));return{$orig:o,l0:r}})));t._isMounted||(t.e0=function(e){t.showSearch=!0},t.e1=function(e){t.is_notice=!1},t.e2=function(e){t.is_notice=!0},t.e3=function(e){t.showSearch=!1},t.e4=function(e){t.showPintuan=!1}),t.$mp.data=Object.assign({},{$root:{l1:n}})},a=!1,s=[];r._withStripped=!0},41:
/*!**************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/order/order.vue?vue&type=script&lang=js& ***!
  \**************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var o=n(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order.vue?vue&type=script&lang=js& */42),r=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},42:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/yingguocheng/pages/order/order.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=s(n(/*! ./node_modules/@babel/runtime/regenerator */4)),r=n(/*! vuex */15),a=n(/*! @/request/api_y.js */23);n(/*! @/util/Date.js */43),s(n(/*! @/util/permission.js */44));function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e,n,o,r,a,s){try{var c=t[a](s),i=c.value}catch(u){return void n(u)}c.done?e(i):Promise.resolve(i).then(o,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function s(t){d(a,o,r,s,c,"next",t)}function c(t){d(a,o,r,s,c,"throw",t)}s(void 0)}))}}var h=function(){n.e(/*! require.ensure | pages/order/components/actions/actions */"pages/order/components/actions/actions").then(function(){return resolve(n(/*! ./components/actions/actions.vue */355))}.bind(null,n)).catch(n.oe)},f=function(){n.e(/*! require.ensure | pages/order/components/notice/notice */"pages/order/components/notice/notice").then(function(){return resolve(n(/*! ./components/notice/notice.vue */362))}.bind(null,n)).catch(n.oe)},p=function(){n.e(/*! require.ensure | pages/order/components/cartbar/cartbar */"pages/order/components/cartbar/cartbar").then(function(){return resolve(n(/*! ./components/cartbar/cartbar.vue */369))}.bind(null,n)).catch(n.oe)},_=function(){n.e(/*! require.ensure | pages/order/components/product-modal/product-modal */"pages/order/components/product-modal/product-modal").then(function(){return resolve(n(/*! ./components/product-modal/product-modal.vue */376))}.bind(null,n)).catch(n.oe)},g=function(){n.e(/*! require.ensure | pages/order/components/search/search */"pages/order/components/search/search").then(function(){return resolve(n(/*! ./components/search/search.vue */383))}.bind(null,n)).catch(n.oe)},m=function(){n.e(/*! require.ensure | pages/order/components/rest/rest */"pages/order/components/rest/rest").then(function(){return resolve(n(/*! ./components/rest/rest.vue */390))}.bind(null,n)).catch(n.oe)},v=function(){n.e(/*! require.ensure | pages/order/components/pintuan/pintuan */"pages/order/components/pintuan/pintuan").then(function(){return resolve(n(/*! ./components/pintuan/pintuan.vue */397))}.bind(null,n)).catch(n.oe)},b=function(){n.e(/*! require.ensure | pages/order/components/locaAutho/locaAutho */"pages/order/components/locaAutho/locaAutho").then(function(){return resolve(n(/*! ./components/locaAutho/locaAutho.vue */404))}.bind(null,n)).catch(n.oe)},S={components:{actions:h,notice:f,productModal:_,cartBar:p,search:g,rest:m,pintuan:v,locaAutho:b},data:function(){return{menu_list:[],title:"英国城",is_notice:!1,menu_id_current:1,goods_scrollTop:0,good:{},goodModalVisible:!1,cart:[],showSearch:!1,localAdress:{},is_rest:!1,showPintuan:!1,showLocaAutho:!1,shop_change_time:0}},watch:{choosedShop:{handler:function(t){var e=this;return l(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(0!=e.shop_change_time){n.next=3;break}return e.shop_change_time=1,n.abrupt("return");case 3:return console.log(e.shop_change_time),console.log(6666666666666666e7),console.log(t),n.next=8,e.menu_list_init();case 8:e.$nextTick((function(){return e.calcSize()})),console.log("bbbbbbbbbbbbbbbbbbbbbbbb");case 10:case"end":return n.stop()}}),n)})))()},deep:!0}},onLoad:function(){var e=this;return l(o.default.mark((function n(){var r,a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=!0,t.getSetting({success:function(t){console.log(t),void 0!=t.authSetting["scope.userLocation"]&&1!=t.authSetting["scope.userLocation"]?(e.showLocaAutho=!0,r=!1):t.authSetting["scope.userLocation"]}}),r){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,e.long_lati();case 6:return a=n.sent,e.loca_res=a,n.next=10,e.shop_init(e.loca_res);case 10:return e.judge_is_rest(),n.next=13,e.menu_list_init();case 13:console.log("order onLoad"),e.$nextTick((function(){return e.calcSize()}));case 15:case"end":return n.stop()}}),n)})))()},onReady:function(){console.log("order onReady")},onShow:function(){var e=this;t.getSetting({success:function(t){console.log(t),void 0!=t.authSetting["scope.userLocation"]&&1!=t.authSetting["scope.userLocation"]&&(e.showLocaAutho=!0)}}),console.log("order onShow"),this.handle_from(),console.log(this.choosedShop),console.log(this.shopList)},onHide:function(){console.log("order onhide"),console.log(this.choosedShop),console.log(this.shopList)},onShareAppMessage:function(t){},computed:i(i({},(0,r.mapState)(["orderType","pintuanType","choosedShop","choosedAddress","orderFrom","shopList"])),{},{contact_number:function(){if(this.choosedAddress.contact_number)return this.choosedAddress.contact_number.length<=9?this.choosedAddress.contact_number:this.choosedAddress.contact_number.substr(0,8)+"..."},shop_adress:function(){if(this.choosedShop.shop_address)return console.log(111111111111),console.log(this.choosedShop),console.log(this.choosedShop.detail),console.log(this.choosedShop),this.choosedShop.shop_address.length<=9?this.choosedShop.shop_address:this.choosedShop.shop_address.substr(0,8)+"..."},notice_list1:function(){if(this.choosedShop&&(console.log("999999999999999999999999"),console.log(this.choosedShop),this.choosedShop.detail)){console.log("cccccccccccccccccccccccccccc");var t=this.choosedShop.detail.scroll_ad;return console.log(t),t}},productCartNum:function(t){var e=this;return function(t){return e.cart.reduce((function(e,n){return n.id===t?e+n.number:e}),0)}},opening_hours:function(){return this.choosedShop.work_time+" - "+this.choosedShop.rest_time}}),methods:i(i({},(0,r.mapMutations)(["SET_ORDER_TYPE","SET_PINTUAN_TYPE","SET_CHOOSED_SHOP","SET_CHOOSED_ADDRESS","SET_ORDER_FROM","SET_SHOP_LIST"])),{},{calcSize:function(){var e=0;this.menu_list.forEach((function(n){var o=t.createSelectorQuery().select("#goods_".concat(n.id));o.fields({size:!0},(function(t){n.top=e,e+=t.height,n.ht=e})).exec()}))},scan:function(){alert("scan"),t.scanCode({scanType:"qrCode",success:function(e){var n=e.result.split(":");(n.length="invitecode"==n[0].trim().toLowerCase())?t.navigateTo({url:"/pages/pintuan/pintuan?invite=true&code="+n[1]}):t.showModal({showCancel:!1,content:"請掃描正確的邀請碼"})}})},openSetting:function(){var e=this;return l(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.openSetting({success:function(){var n=l(o.default.mark((function n(r){var a;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(1!=r.authSetting["scope.userLocation"]){n.next=13;break}return e.showLocaAutho=!1,n.next=4,e.long_lati();case 4:return a=n.sent,e.judge_is_rest(),n.next=8,e.shop_init(a);case 8:return n.next=10,e.menu_list_init();case 10:e.$nextTick((function(){return e.calcSize()})),n.next=14;break;case 13:t.showToast({title:"授权失败",icon:"none",duration:1e3});case 14:case"end":return n.stop()}}),n)})));function r(t){return n.apply(this,arguments)}return r}()});case 1:case"end":return n.stop()}}),n)})))()},judge_is_rest:function(){var e=this;return l(o.default.mark((function n(){var r;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,a.shops_detail)({shop_id:e.choosedShop.id});case 2:r=n.sent.data.work_status,1!=r&&(e.is_rest=!0,t.showModal({content:"本店已休息，您可以選擇切換門店",cancelText:"留在當前",confirmText:"切換門店",success:function(e){e.confirm?t.navigateTo({url:"/pages/chooseShop/chooseShop"}):e.cancel}}));case 4:case"end":return n.stop()}}),n)})))()},handle_from:function(){switch(this.orderFrom){case"home_tssx":var t=this.menu_list.find((function(t){return"特色手信"==t.menu_name}));this.menu_id_current=t.id,this.goods_scrollTop=t.top+Math.random(),this.SET_ORDER_FROM("");break}},pin_tap:function(){var e=this;return l(o.default.mark((function n(){var r,s,c,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.getStorageSync("token"),console.log(r),!r){n.next=33;break}if(s=t.getStorageSync("pintuanCode"),!s){n.next=19;break}return n.prev=5,console.log("cccccccccccccc"),n.next=9,(0,a.pintuan_detail)({code:s});case 9:c=n.sent,console.log("aaaaaaaaaaaaaaaaa"),1001==c.code?(console.log("bbbbbbbbbbbbbbbb"),e.showPintuan=!0):t.navigateTo({url:"/pages/pintuan/pintuan?code="+s}),n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](5),console.log(n.t0);case 17:n.next=31;break;case 19:return n.prev=19,n.next=22,(0,a.pintuan_creat)();case 22:i=n.sent,console.log("res_pcres_pcres_pcres_pcres_pcres_pcres_pcres_pcres_pcres_pcres_pcres_pc"),console.log(i),1e3==i.code?(t.setStorage({key:"pintuanCode",data:i.data.code}),t.navigateTo({url:"/pages/pintuan/pintuan?code="+i.data.code})):e.showPintuan=!0,n.next=31;break;case 28:n.prev=28,n.t1=n["catch"](19),console.log(n.t1);case 31:n.next=34;break;case 33:t.showModal({content:"您還沒有登錄，請先登錄",success:function(e){e.confirm?t.navigateTo({url:"/pages/login/login?from=order"}):e.cancel}});case 34:case"end":return n.stop()}}),n,null,[[5,14],[19,28]])})))()},loca_tap:function(){1==this.orderType?t.navigateTo({url:"/pages/userAdress/userAdress"}):t.navigateTo({url:"/pages/chooseShop/chooseShop"})},switch_shop:function(){t.navigateTo({url:"/pages/chooseShop/chooseShop"})},order_type_tap:function(e){1==e?t.navigateTo({url:"/pages/userAdress/userAdress"}):this.SET_ORDER_TYPE(e)},menu_Tap:function(t){this.showLoca=!this.showLoca,this.menu_id_current=t,this.goods_scrollTop=this.menu_list.find((function(e){return e.id==t})).top+Math.random(),console.log(this.goods_scrollTop)},goods_scroll:function(t){var e=t.detail,n=e.scrollTop;n=Math.ceil(n)+1;var o=this.menu_list.filter((function(t){return t.top<=n&&t.ht>n}));o.length>0&&(this.menu_id_current=o[0].id)},showProductDetailModal:function(t){this.good=t,this.goodModalVisible=!0},handleAddToCart:function(t){console.log(this.productCartNum());var e=this.cart.findIndex((function(e){return t.materials&&t.materials.length?e.id==t.id&&e.materials_text==t.materials_text:e.id===t.id}));e>-1?this.cart[e].number+=t.number||1:this.cart.push({id:t.id,name:t.name,price:t.price,truePrice:t.truePrice||t.price,number:t.number||1,imgurl:t.imgurl,norm_id:t.norm_id,materials_text:t.materials_text||"",is_checked:!0})},handleMinusFromCart:function(t){var e;e=t.materials&&!t.materials.length?this.cart.findIndex((function(e){return e.id==t.id})):this.cart.findIndex((function(e){return e.id==t.id&&e.materials_text==t.materials_text})),this.cart[e].number-=1,this.cart[e].number<=0&&this.cart.splice(e,1)},handleAddToCartInModal:function(t){this.handleAddToCart(t),this.closeProductDetailModal()},closeProductDetailModal:function(){this.goodModalVisible=!1,this.good={}},clearCart:function(){this.cart=[]},checkAllChange:function(t){var e=t.detail.value;console.log(t),e.length>0?this.cart.forEach((function(t){return t.is_checked=!0})):this.cart.forEach((function(t){return t.is_checked=!1}))},checkboxChange:function(t){var e=t.detail.value,n=t.currentTarget.dataset.good;console.log(t),console.log(n),e.length>0?this.cart.find((function(t){return t.id==n.id&&t.materials_text==n.materials_text})).is_checked=!0:this.cart.find((function(t){return t.id==n.id&&t.materials_text==n.materials_text})).is_checked=!1},choose_pintuan_type:function(e){var n=this;return l(o.default.mark((function r(){return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:n.showPintuan=!1,1==e?(n.SET_PINTUAN_TYPE(1),t.navigateTo({url:"/pages/pintuan/pintuan"})):(n.SET_PINTUAN_TYPE(2),t.navigateTo({url:"/pages/pintuan/pintuan"}));case 2:case"end":return o.stop()}}),r)})))()},pay:function(e){var n=t.getStorageSync("token");if(console.log(n),n){if(this.judge_is_rest(),!this.is_rest){t.showLoading({});var o=getApp(),r={},a=[];if(this.cart.filter((function(t){return 1==t.is_checked})).forEach((function(t){var e={};e.id=t.id,e.goods_name=t.name,e.goods_price=t.truePrice,e.home_avatar=t.imgurl,e.norm=t.materials_text,e.norm_id=t.norm_id?t.norm_id:[],e.goods_num=t.number,a.push(e)})),0==a.length)return void t.showModal({content:"您還沒有選購商品",showCancel:!1});r.goods_data=a,r.shop_id=this.choosedShop.id,r.shop_name=this.choosedShop.shop_name,r.distance=this.choosedShop.distance,r.delivery_cost=parseInt(100*this.choosedShop.detail.delivery_cost)/100,r.lowest_cost=parseInt(100*this.choosedShop.detail.lowest_cost)/100,r.payment_info=e,r.address_id=this.choosedAddress.id,r.contact_name=this.choosedAddress.contact_name,r.contact_sex=this.choosedAddress.contact_sex,r.contact_phone=this.choosedAddress.contact_phone,r.contact_address=this.choosedAddress.contact_address,r.contact_number=this.choosedAddress.contact_number,r.haul_method=this.orderType,r.current_cups=this.choosedShop.detail.current_cups,r.current_order=this.choosedShop.detail.current_order,o.globalData.goodsPayment=r,console.log(r),t.hideLoading(),t.navigateTo({url:"/pages/orderPayment/orderPayment"})}}else t.showModal({content:"您還沒有登錄，請先登錄",success:function(e){e.confirm?t.navigateTo({url:"/pages/login/login?from=order"}):e.cancel}})},long_lati:function(){return l(o.default.mark((function e(){var n,r,a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=0,r=0,e.next=4,new Promise((function(e,n){t.getLocation({success:function(t){e(t)},fail:function(t){return l(o.default.mark((function t(){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()}})})).catch((function(t){}));case 4:return a=e.sent,n=a.latitude,r=a.longitude,console.log("latitude:"+n+"longitude:"+r),e.abrupt("return",{latitude:n,longitude:r});case 9:case"end":return e.stop()}}),e)})))()},shop_init:function(t){var e=this;return l(o.default.mark((function n(){var r,s;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,a.shops_list)({latitude:t.latitude,longitude:t.longitude});case 2:return r=n.sent.data,r.sort((function(t,e){return parseInt(100*t.distance)<=parseInt(100*e.distance)?-1:1})),s=[],r.forEach(function(){var t=l(o.default.mark((function t(e,n){return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.push((0,a.shops_detail)({shop_id:e.id}));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),n.next=8,Promise.all(s).then((function(t){var e=0;r.forEach((function(n){n.detail=t[e].data,e++}))}));case 8:console.log(r),e.SET_SHOP_LIST(r),e.SET_CHOOSED_SHOP(e.shopList[0]);case 11:case"end":return n.stop()}}),n)})))()},menu_list_init:function(){var t=this;return l(o.default.mark((function e(){var n,r,s;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,a.goods_list)({shop_id:t.choosedShop.id});case 2:return n=e.sent.data,console.log(n),r=[],s=[],n.forEach((function(e){var n={};n.id=e.id,n.icon_url=t.imgSrc+e.home_avatar,n.menu_name=e.classify_name,n.goods_list=[],e.child&&e.child.length&&e.child.forEach((function(e){var o={};o.id=e.id,o.name=e.goods_name,o.labels=e.goods_label,o.materials=[],o.description=e.goods_detail,o.imgurl=t.imgSrc+e.home_avatar,o.price=parseInt(100*e.goods_price)/100,o.sell_status=e.sell_status,o.goods_norm=e.goods_norm,n.goods_list.push(o),r.push((0,a.goods_detail)({goods_id:e.id}))})),s.push(n)})),console.log(s),e.next=10,Promise.all(r).then((function(e){console.log(e);var n=0;s.forEach((function(o){o.goods_list.forEach((function(o){var r=[],a=[];e[n].data.goods_avatar.forEach((function(e){r.push(t.imgSrc+e)})),e[n].data.goods_norm.forEach((function(t){var e={};e.group_name=t.name,e.values=[],t.child.forEach((function(t){var n={};n.id=t.id,n.parent_id=t.parent_id,n.name=t.value,n.price=parseInt(100*t.price)/100,e.values.push(n)})),console.log("fffffffffffff"),console.log(e),a.push(e),console.log(a)})),o.images=r,o.materials=a,n++}))})),console.log(s)}));case 10:t.menu_list=s;case 11:case"end":return e.stop()}}),e)})))()},init:function(){var e=this;return l(o.default.mark((function n(){var r,s;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=0,s=0,t.getLocation({type:"gcj02",altitude:!0,success:function(){var t=l(o.default.mark((function t(n){var c,i,u,d;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=n.latitude,s=n.longitude,t.next=4,(0,a.shops_list)({latitude:r,longitude:s});case 4:return c=t.sent.data,console.log("latitude:"+r+"longitude:"+s),console.log(c),e.SET_SHOP_LIST(c),e.shopList.sort((function(t,e){return parseInt(100*t.distance)<=parseInt(100*e.distance)?-1:1})),console.log(c),e.shopList.forEach(function(){var t=l(o.default.mark((function t(e){var n;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,a.shops_detail)({shop_id:e.id});case 2:n=t.sent.data,console.log(n),e.detail=n;case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.SET_CHOOSED_SHOP(e.shopList[0]),console.log(e.choosedShop),t.next=15,(0,a.goods_list)({shop_id:e.choosedShop.id});case 15:return i=t.sent.data,console.log(e.choosedShop),console.log(i),u=[],console.log(e.choosedShop),d=[],i.forEach((function(t){var n={};if(n.id=t.id,n.icon_url=e.imgSrc+t.home_avatar,n.menu_name=t.classify_name,n.goods_list=[],t.child&&t.child.length){var o={};t.child.forEach((function(t){o.id=t.id,o.name=t.goods_name,o.labels=t.goods_label,o.materials=[],o.description=t.goods_detail,o.imgurl=e.imgSrc+t.home_avatar,o.price=t.goods_price,o.sell_status=t.sell_status,o.goods_norm=t.goods_norm,n.goods_list.push(o),u.push((0,a.goods_detail)({goods_id:t.id}))}))}d.push(n)})),console.log(d),t.next=25,Promise.all(u).then((function(t){console.log(t);var n=0;d.forEach((function(o){o.goods_list.forEach((function(o){var r=[],a=[];t[n].data.goods_avatar.forEach((function(t){r.push(e.imgSrc+t)})),console.log(t[n].data.goods_norm),t[n].data.goods_norm.forEach((function(t){var e={};e.group_name=t.name,e.values=[],t.child.forEach((function(t){var n={};n.id=t.id,n.parent_id=t.parent_id,n.name=t.value,n.price=t.price,e.values.push(n)})),console.log("fffffffffffff"),console.log(e),a.push(e),console.log(a)})),o.images=r,o.materials=a}))})),console.log(d)}));case 25:console.log("bojjijijj"),e.menu_list=d;case 27:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()});case 3:case"end":return n.stop()}}),n)})))()}})};e.default=S}).call(this,n(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},45:
/*!***********************************************************************************************************************************!*\
  !*** C:/Users/Administrator/Desktop/yingguocheng/pages/order/order.vue?vue&type=style&index=0&id=127632e4&lang=scss&scoped=true& ***!
  \***********************************************************************************************************************************/
/*! no static exports found */function(t,e,n){"use strict";n.r(e);var o=n(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./order.vue?vue&type=style&index=0&id=127632e4&lang=scss&scoped=true& */46),r=n.n(o);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=r.a},46:
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Administrator/Desktop/yingguocheng/pages/order/order.vue?vue&type=style&index=0&id=127632e4&lang=scss&scoped=true& ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,n){}},[[111,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/orderPayment/orderPayment.js.map